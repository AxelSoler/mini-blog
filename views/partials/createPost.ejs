<section class="mb-4 flex flex-col items-center" x-data="{ showModal: false }">
  <button
    @click="showModal = true"
    class="bg-blue-600 hover:bg-blue-700 text-white text-2xl px-4 py-2 rounded font-bold disabled:opacity-50 disabled:cursor-not-allowed"
    x-bind:disabled="<%= !currentUser || postCount >= maxPosts %>"
  >
    Create New Post
  </button>

  <% if (!currentUser) { %>
    <p class="text-red-600 mt-2 font-bold">Please log in to create a post.</p>
  <% } else if (postCount >= maxPosts) { %>
    <p class="text-red-600 mt-2 font-bold">You have reached the maximum of <%= maxPosts %> posts.</p>
  <% } %>

  <div
    x-show="showModal"
    x-transition
    class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 px-4"
  >
    <div class="bg-white p-6 rounded w-full max-w-96 relative">
      <h3 class="text-lg font-semibold mb-4">Create Post</h3>
      <button
        @click="showModal = false"
        class="text-gray-500 hover:text-gray-700 text-4xl font-bold absolute top-2 right-4"
      >
        &times;
      </button>
      <form action="/create" method="POST" class="space-y-2">
        <input
          type="text"
          name="title"
          placeholder="Title"
          class="border p-2 w-full"
          required
        />
        <textarea
          name="content"
          placeholder="Content"
          class="border p-2 w-full"
          required
        ></textarea>
        <button
          type="submit"
          class="bg-blue-600 text-white px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed"
          x-bind:disabled="<%= !currentUser || postCount >= maxPosts %>"
        >
          Create Post
        </button>
      </form>
    </div>
  </div>
</section>
